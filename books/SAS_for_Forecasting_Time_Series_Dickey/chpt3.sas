*-------------------------------------------------------------------*/
 /*         SAS FOR FORECASTING TIME SERIES, SECOND EDITION           */
 /*          by John C. Brocklebank and David A. Dickey               */
 /*       Copyright(c) 2003 by SAS Institute Inc., Cary, NC, USA      */
 /*                   SAS Publications order # 57275                  */
 /*  Jointly co-published by SAS Institute and John Wiley & Sons 2003 */
 /*                   SAS ISBN 1-59047-182-2                          */
                John Wiley & Sons, Inc. ISBN 0-471-39566-8            */
 /*-------------------------------------------------------------------*/
 /*                                                                   */
 /* This material is provided "as is" by SAS Institute Inc.  There    */
 /* are no warranties, expressed or implied, as to merchantability or */
 /* fitness for a particular purpose regarding the materials or code  */
 /* contained herein. The Institute is not responsible for errors     */
 /* in this material as it now exists or will exist, nor does the     */
 /* Institute provide technical support for it.                       */
 /*                                                                   */
 /*-------------------------------------------------------------------*/
 /* Questions or problem reports concerning this material may be      */
 /* addressed to the author:                                          */
 /*                                                                   */
 /* SAS Institute Inc.                                                */
 /* Books by Users                                                    */
 /* Attn: John Brocklebank and David Dickey                           */
 /* SAS Campus Drive                                                  */
 /* Cary, NC   27513                                                  */
 /*                                                                   */
 /*                                                                   */
 /* If you prefer, you can send email to:  sasbbu@sas.com             */
 /* Use this for subject field:                                       */
 /*     Comments for John Brocklebank and David Dickey                */
 /*                                                                   */
 /*-------------------------------------------------------------------*/


 /* Use the DATA step below with the appropriate PROC statements in   */
 /* Chapter 3, "The General ARIMA Model," of SAS FOR FORECASTING      */
 /* TIME SERIES, SECOND EDITION, to produce Output 3.1-3.5, and 3.10. */
                                                        

OPTIONS MACROGEN SYMBOLGEN MPRINT;   
%MACRO MPACF; 
   TOEP=TOEPLITZ(A); G=TOEP[1:10,1:10];
   A=A[1,2:11]; A=A`;
   APACF={0,0,0,0,0,0,0,0,0,0};
   DO H=1 TO 10;
      P=INV(G[1:H,1:H])*A[1:H,1];
   APACF[H,1]=P[H,1];
   END;
%MEND MPACF;

DATA SERIES;
   FORMAT T YAR1 YMA1 Y1-Y8 7.2;
   DO T=-25 TO 150;
      YAR1L=YAR1;    Y1L1=Y1;
      Y2L1=Y2;       Y3L2=Y3L1;
      Y3L1=Y3;       Y4L2=Y4L1;
      Y4L1=Y4;       Y8L1=Y8;
      EL2=EL1;       EL1=E;
      E=NORMAL(1234567);
      YAR1=SUM(100,.8*YAR1L,-80,E);
      YMA1=SUM(100,E,.8*EL1);
      Y1=SUM(.8*Y1L1,E);
      Y2=SUM(-.8*Y2L1,E);
      Y3=SUM(.3*Y3L1,.4*Y3L2,E);
      Y4=SUM(.7*Y4L1,-.49*Y4L2,E);
      Y5=SUM(E,+.8*EL1);
      Y6=SUM(E,-.3*EL1,-.4*EL2);
      Y7=E;
      Y8=SUM(.6*Y8L1,E,.4*EL1);
      OUTPUT;
   END;
RUN;

DATA SERIES;
   SET SERIES;
   IF T>0;
RUN;

DATA SERIES;
   SET SERIES;
   KEEP T YAR1 YMA1 Y1-Y8;
RUN;

PROC IML;
   RESET PRINT; USE SERIES; READ ALL INTO X;
   N={25};  YAR1=X[,2]; ZYAR1=COVLAG(YAR1,N); A=ZYAR1;  
   %MPACF;
   EPCFYAR1=APACF; PHI={1,-.8}; THETA={1};
   CALL ARMACOV(AYAR1,CYAR1,MYAR1,PHI,THETA,N);
   A=AYAR1;
   %MPACF;
   APCFYAR1=APACF; YMA1=X[,3]; ZYMA1=COVLAG(YMA1,N); A=ZYAR1;
   %MPACF;
   EPCFYMA1=APACF; PHI=1; THETA={1,.8};
   CALL ARMACOV(AYMA1,CYMA1,MYMA1,PHI,THETA,N);
   A=AYMA1;
   %MPACF;
   APCFYMA1=APACF; Y1=X[,4]; ZY1=COVLAG(Y1,N); A=ZY1;
   %MPACF;
   EPCFY1=APACF; ZY1=ZY1/ZY1[1,1]; PHI={1,-.8}; THETA=1;
   CALL ARMACOV(AY1,CY1,MY1,PHI,THETA,N);
   ECORY1=ZY1; ACORY1=AY1/AY1[1,1]; A=AY1; 
   %MPACF;
   APACFY1=APACF; Y2=X[,5]; ZY2=COVLAG(Y2,N); A=ZY2;
   %MPACF;
   EPCFY2=APACF; ZY2=ZY2/ZY2[1,1]; PHI={1,.8}; THETA=1;
   CALL ARMACOV(AY2,CY2,MY2,PHI,THETA,N);
   ECORY2=ZY2; ACORY2=AY2/AY2[1,1]; A=AY2;
   %MPACF;
   APACFY2=APACF; Y3=X[,6]; ZY3=COVLAG(Y3,N); A=ZY3;
   %MPACF;
   EPCFY3=APACF; ZY3=ZY3/ZY3[1,1]; PHI={1,-.3,-.4}; THETA=1;
   CALL ARMACOV(AY3,CY3,MY3,PHI,THETA,N);
   ECORY3=ZY3; ACORY3=AY3/AY3[1,1]; A=AY3;
   %MPACF;
   APACFY3=APACF; Y4=X[,7]; ZY4=COVLAG(Y4,N); A=ZY4;
   %MPACF;
   EPCFY4=APACF; ZY4=ZY4/ZY4[1,1]; PHI={1,-.7,.49}; THETA=1;
   CALL ARMACOV(AY4,CY4,MY4,PHI,THETA,N);
   ECORY4=ZY4; ACORY4=AY4/AY4[1,1]; A=AY4; 
   %MPACF;
   APACFY4=APACF; Y5=X[,8]; ZY5=COVLAG(Y5,N); A=ZY5;
   %MPACF;
   EPCFY5=APACF; ZY5=ZY5/ZY5[1,1]; PHI=1; THETA={1,.8};
   CALL ARMACOV(AY5,CY5,MY5,PHI,THETA,N);
   ECORY5=ZY5; ACORY5=AY5/AY5[1,1]; A=AY5;
   %MPACF;
   APACFY5=APACF; Y6=X[,9]; ZY6=COVLAG(Y6,N); A=ZY6;
   %MPACF;
   EPCFY6=APACF; ZY6=ZY6/ZY6[1,1]; PHI=1; THETA={1,-.3,-.4};
   CALL ARMACOV(AY6,CY6,MY6,PHI,THETA,N);
   ECORY6=ZY6; ACORY6=AY6/AY6[1,1]; A=AY6;
   %MPACF;
   APACFY6=APACF; Y7=X[,10]; ZY7=COVLAG(Y7,N); A=ZY7;
   %MPACF;
   EPCFY7=APACF; ZY7=ZY7/ZY7[1,1]; PHI=1; THETA=1;
   CALL ARMACOV(AY7,CY7,MY7,PHI,THETA,N);
   ECORY7=ZY7; ACORY7=AY7/AY7[1,1]; A=AY7;
   %MPACF;
   APACFY7=APACF; Y8=X[,11]; ZY8=COVLAG(Y8,N); A=ZY8;
   %MPACF;
   EPCFY8=APACF; ZY8=ZY8/ZY8[1,1]; PHI={1,-.6}; THETA={1,.4};
   CALL ARMACOV(AY8,CY8,MY8,PHI,THETA,N);
   ECORY8=ZY8/ZY8[1,1]; ACORY8=AY8/AY8[1,1]; A=AY8;
   %MPACF;
   APACFY8=APACF;
   OUTTOP=AYAR1`||AYMA1`||ACORY1`||ACORY2`||ACORY3`||
          ACORY4`||ACORY5`||ACORY6`||ACORY7`||ACORY8`;
   OUTBOT=ZYAR1`||ZYMA1`||ECORY1`||ECORY2`||ECORY3`||
          ECORY4`||ECORY5`||ECORY6`||ECORY7`||ECORY8`;
   OUTBOT2=APCFYAR1||APCFYMA1||APACFY1||APACFY2||APACFY3||
           APACFY4||APACFY5||APACFY6||APACFY7||APACFY8;
   OUTBOT3=EPCFYAR1||EPCFYMA1||EPCFY1||EPCFY2||EPCFY3||
           EPCFY4||EPCFY5||EPCFY6||EPCFY7||EPCFY8;
   MOUT=OUTTOP//OUTBOT;MOUT2=OUTBOT2//OUTBOT3;
     COLNAME1=
   {'covyar1' 'covyma1' 'cory1' 'cory2' 'cory3' 'cory4'
      'cory5' 'cory6' 'cory7' 'cory8'};
   CREATE COV FROM MOUT[COLNAME=COLNAME1];
   APPEND FROM MOUT;
   COLNAME1={'covyar1' 'covyma1' 'cory1' 'cory2' 'cory3' 'cory4'
      'cory5' 'cory6' 'cory7' 'cory8'};
   CREATE APACF FROM OUTBOT2[COLNAME=COLNAME1];
   APPEND FROM OUTBOT2;
   COLNAME1={'pacyar1' 'pacyma1' 'pacy1' 'pacy2' 'pacy3' 'pacy4'
      'pacy5' 'pacy6' 'pacy7' 'pacy8'};
   CREATE EPACF FROM MOUT2[COLNAME=COLNAME1];
   APPEND FROM MOUT2;   
RUN;

DATA COV;
   RETAIN T;
   LENGTH _TYPE_ $ 9;
   SET COV;
   IF _N_<=25 THEN _TYPE_='ACTUAL';
   ELSE _TYPE_='ESTIMATED';
   IF _N_=1 OR _N_=26 THEN T=-1;T=T+1;
   LABEL T='LAG';
RUN;

DATA APACF;
   SET APACF;
   T=_N_;
   _TYPE_='PACF';
RUN;   

DATA APACFACF;
   SET APACF COV;
   IF T<=10;
   IF _TYPE_ NE :'E';
   IF _TYPE_=:'A' THEN _TYPE_='ACF';
RUN;

DATA PAC;
   SET EPACF;
   LENGTH _TYPE_ $ 9;
   RETAIN T;
   IF _N_<=10 THEN _TYPE_='ACTUAL';
   ELSE _TYPE_='ESTIMATED';
   IF _N_=1 OR _N_=11 THEN T=0; 
   T=T+1;
   LABEL T='LAG';
RUN;

DATA COV;
   SET COV;
   IF T<=10;
   LABEL T='LAG';
RUN;

DATA COVA;
   SET COV;
   IF _TYPE_=:'A';
RUN;

 /* Use the DATA step below with the appropriate PROC statements in   */
 /* Chapter 3, "The General ARIMA Model," of the SAS FOR              */
 /* FORECASTING TIME SERIES, SECOND EDITION, to produce Output 3.6-   */
 /* Output 3.9.                                                       */


DATA STEEL;
   INPUT EXPORT @@;
   TITLE 'IRON AND STEEL EXPORTS EXCLUDING SCRAPS';
   TITLE2 'WEIGHT IN MILLION TONS';
   TITLE3 '1937-1980';
   RETAIN YEAR 1936;
   YEAR+1;
   CARDS;
 3.89 2.41 2.8  8.72 7.12 7.24 7.15 6.05 5.21 5.03 6.88 4.7  5.06 3.16
 3.62 4.55 2.43 3.16 4.55 5.17 6.95 3.46 2.13 3.47 2.79 2.52 2.8  4.04
 3.08 2.28 2.17 2.78 5.94 8.14 3.55 3.61 5.06 7.13 4.15 3.86 3.22
 3.5  3.76 5.11
;
RUN;


 /* Use the DATA step below with the appropriate PROC statements in  */
 /* Chapter 3, "The General ARIMA Model," of the SAS FOR             */
 /* FORECASTING TIME SERIES, SECOND EDITION, to produce Output 3.11- */
 /* Output 3.14.                                                     */


TITLE 'SERIES B';
TITLE2 'IBM DAILY STOCK PRICES 17MAY61 TO 2NOV62';

DATA IBM;
   INPUT PRICE @@;
   RETAIN;
   T=_N_;
   CARDS;
460 457 452 459 462 459 463 479 493 490 492 498 499 497 496 490 489 478
487 491 487 482 479 478 479 477 479 475 479 476 476 478 479 477 476 475
475 473 474 474 474 465 466 467 471 471 467 473 481 488 490 489 489 485
491 492 494 499 498 500 497 494 495 500 504 513 511 514 510 509 515 519
523 519 523 531 547 551 547 541 545 549 545 549 547 543 540 539 532 517
527 540 542 538 541 541 547 553 559 557 557 560 571 571 569 575 580 584
585 590 599 603 599 596 585 587 585 581 583 592 592 596 596 595 598 598
595 595 592 588 582 576 578 589 585 580 579 584 581 581 577 577 578 580
586 583 581 576 571 575 575 573 577 582 584 579 572 577 571 560 549 556
557 563 564 567 561 559 553 553 553 547 550 544 541 532 525 542 555 558
551 551 552 553 557 557 548 547 545 545 539 539 535 537 535 536 537 543
548 546 547 548 549 553 553 552 551 550 553 554 551 551 545 547 547 537
539 538 533 525 513 510 521 521 521 523 516 511 518 517 520 519 519 519
518 513 499 485 454 462 473 482 486 475 459 451 453 446 455 452 457 449
450 435 415 398 399 361 383 393 385 360 364 365 370 374 359 335 323 306
333 330 336 328 316 320 332 320 333 344 339 350 351 350 345 350 359 375
379 376 382 370 365 367 372 373 363 371 369 376 387 387 376 385 385 380
373 382 377 376 379 386 387 386 389 394 393 409 411 409 408 393 391 388
396 387 383 388 382 384 382 383 383 388 395 392 386 383 377 364 369 355
350 353 340 350 349 358 360 360 366 359 356 355 367 357 361 355 348 343
330 340 339 331 345 352 346 352 357
;
RUN;


 /* Use the DATA step below with the appropriate PROC statements in       */
 /* Chapter 3, "The General ARIMA Model," of SAS FOR                      */
 /* FORECASTING TIME SERIES, SECOND EDITION, to produce Output 3.15-3.18. */

DATA SILVER;
   INPUT SILVER @@; DEL = SILVER-LAG(SILVER);
   TITLE 'MONTH END STOCKS OF SILVER';
   RETAIN DATE '01DEC75'D;
   DATE=INTNX('MONTH',DATE,1);
   FORMAT DATE MONYY.;
   PART=1;
   IF DATE > '01APR80'D THEN PART=2;
   IF PART=1 THEN SILV=SILVER;
   ELSE SILV=.;
   OUTPUT;
   RETAIN;
   DEL4=DEL3;
   DEL3=DEL2;
   DEL2=DEL1;
   DEL1=DEL;
   LSILVER=SILVER;
  *  SAS dataset up to 845.  Some errors found and
     corrected                 ;
   CARDS;
 846  827  799  768  719  652  580  546  500  493  530  548 
 565  572  632  645  674  693  706  661  648  604  647  684 
 700  723  741  734  708  728  737  729  678  651  627  582 
 521  519  496  501  555  541  485  476  515  606  694  748 
 761  794  836  845  
                     822  820  826  826  821  871  858  866 
 859  854  854  853  848  867  856  785  774  758  773  776 
 769  783  771  814  780  729  662  606  615  579  800  907 
 904 1064  972  914  899  909  921 1136 1293 1279 1298 1274 
1238 1174 1168 1153 1136 1209 1205 1151 1150 1145 1149 1185 
1215 1233 1066 1068 1042 1324 1393 1434 1440 1492 1537 1553 
1432 1453 1482 1552 1479 1519 1502 1587 1568 1377 1449 1454 
1502 1600 1573 1577 1561 1522 1521 1601 1564 1548 1558 1563 
;
RUN;
PROC ARIMA data=silver;
  i var=silv center stationarity=(ADF=1) noprint;
  e p=2 ml noprint;
  f lead=72 out=outs ID=DATE INTERVAL=MONTH NOOUTALL;
run; 
  PROC PRINT; run;
PROC ARIMA data=silver;
  i var=silv(1) noprint;
  e p=1 ml noconstant noprint;
  f lead=72 out=outn ID=DATE INTERVAL=MONTH NOOUTALL;
run;
DATA SILVER2; 
   MERGE SILVER OUTS(RENAME= (FORECAST=FORS U95=US L95=LS))
                OUTN(RENAME= (FORECAST=FORN U95=UN L95=LN)) ;
   BY DATE;
   IF DATE > '01JAN82'D THEN DO;
      UN=.;
      LN=.;
   END;
   IF DATE > '01JAN84'D THEN DO;
   US=.;
   LS=.;
   END;
RUN;

/*3.19-3.22*/

DATA AMAZON;
   INPUT DATE OPEN HIGH LOW CLOSE VOLUME;
   TITLE "DATA ON AMAZON.COM STOCK";
   OPEN=LOG(OPEN);
   CLOSE=LOG(CLOSE);
   HIGH=LOG(HIGH);
   LOW=LOG(LOW);
   VOLUME=LOG(VOLUME);
   TITLE2 "DATA IN LOGORITHMS";
   SPREAD=HIGH-LOW;
   FORMAT DATE DATE7.;
   CARDS;
14389      117.25      121.125     111.375     111.5625    7755100 
14388      128.625     129.375     116         117.5       7126900 
14385      130.75      132         125.75      128.5625    4002800 
14384      136.75      138         130.5       130.8125    3447000 
14383      133.9375    139.625     133.5       139.5625    6309600 
14382      136.4375    137.5       130.9375    132.625     6203900 
14381      130         138         121.5       137.625     10429100 
14378      133.125     134.75      129.8125    132.375     5633400 
14377      144.375     147.875     136         136         5749500 
14376      148.0625    148.625     141.5       142.9375    3663700 
14375      150.6875    153.875     144         148.375     6970700 
14374      136.625     147         134         146.875     7120600 
14371      140.75      144         131         136.375     8327000 
14370      148         151         135.75      137.375     9142200 
14369      143.875     148.25      133.875     146.5       13854900 
14368      152.625     160.5       140.5       143         10848200 
14367      166.875     167.062     150.125     150.938     13093200 
14364      177         180         165         172.062     8888200 
14363      172.438     181.75      165         168.25      21104200 
14362      200         202         182.375     193.5       9736900 
14361      217         221.25      202         205.875     8947700 
14360      209         215.875     204         207.188     6992500 
14357      192.875     216.5       191.75      210.125     15858400 
14356      184.312     191         177.938     190.062     6269100 
14355      172.375     182         169         179.25      5541000 
14354      157.312     174.312     153.5       172         10002500 
14353      189         189         155         158.938     14184900 
14350      183.875     191.5       180.688     190         15830100 
14349      165.875     170.5       151         167.25      8249200 
14348      182         184.5       166.625     168         4976400  
14347      186.75      192         178.25      178.375     4019400 
14346      176.125     188.25      176         184.438     4284600 
14343      178.125     186         175.75      182.875     3419500 
14342      174.812     184.125     166         179         5743900 
14341      186.625     187.312     171.25      175.812     6583300 
14340      184.5       195.75      179.5       182.875     7265900 
14339      172.625     187.5       171.75      186.5       7958400 
14335      179.375     180.125     167.5       171         5786600 
14334      171.25      178         165.125     172.188     11047100 
14333      152         169.5       151.531     164.688     13088700 
14332      150         151.5       148         149.625     9444000 
14329      140         147.75      137.375     139.062     12461000 
14328      128.938     140         128.188     139.875     8049900 
14327      117.188     124         114         123.688     5771900  
14326      128.625     129.875     118         119.375     5608400  
14325      133.188     136.5       130.5       132         3299200 
14322      141.875     143.062     135         135.062     5362600 
14321      132.875     140         132.375     138.438     6150100 
14320      131.312     133.5       128.25      131         3933700  
14319      139         140.375     132.75      133.812     3767200 
14318      133         139         131         138.938     3510400 
14315      134         135.375     128.625     133.312     4666300 
14314      139.75      142.75      131         134.875     8126100 
14313      136.75      138.938     134         137.125     7058800 
14312      125.125     133.25      123.438     129.938     8146000 
14311      121.438     126.438     119.25      122.188     5231300 
14308      123.938     124.5       118.375     121.5       6088100 
14307      125.5       127         115.875     120.125     8943700 
14306      123.75      127.5       120.25      123.5       7764400 
14305      134.438     135.75      121.062     121.312     8301600 
14304      127         136.062     124         133         9684500 
14301      126.75      130         121         128.125     12682700 
14300      116.625     125.625     114.625     125         18344900 
14299      117.625     122.188     110.25      110.938     12393200 
14298      110.125     117         109.5       115.188     10569600 
14297      101.75      109.625     98          106.5       9606100 
14294      94.375      102.5       91          101.875     13459100 
14293      96.5        96.5        84.25       89.5        10781300 
14292      98.4375     102.062     92.5        93.5        4834300 
14291      106.875     108.5       97          98.625      3889900 
14287      108         109.875     103.625     104.5       3882700 
14286      100.5       110.188     99.5        109.875     6896500 
14285      98.25       103.375     95          97.4375     6602500 
14284      107.938     108         99.9375     100         6413000 
14283      114.375     115.125     105.75      109.125     6299100 
14280      117         122.875     112.312     115.875     4283000 
14279      125.25      126.75      116.25      118         5824800 
14278      109         126         108.5       125.75      9395500 
14277      116.375     116.438     108.5       110.25      6524300 
14276      117.75      122.312     115         115.875     6390500 
14273      121.625     121.625     115         116.938     8198000 
14272      126.438     128.75      120.25      122.875     11875300 
14271      134.125     139.75      120         125.625     17511300 
14270      112.625     121.25      110.625     115.094     12267400 
14269      121.5       123.375     110         112.375     13661900 
14266      99.5        125.875     98.75       123         21882900 
14265      104.5       110.375     92.5625     106         23524100 
14264      135.062     137         109.75      113         15267600 
14263      150.5       150.5       136.25      139.812     5702700 
14259      140         150.062     137.625     140.375     10066300 
14258      150         159.25      136         138         10456200 
14257      125         163.5       125         148         14938200 
14256      180.5       182         159         163.375     12221600 
14255      184         185         167.625     184.625     19461500 
14252      184.25      199.125     152         160.25      33331100 
14251      137.125     160.25      133         158.875     23637300 
14250      136.375     140.375     134         138         18088300 
14249      109.562     129.75      106.5       124.5       31436600 
14248      109.229     118.667     106.625     118.312     6548700 
14244      105.75      110.333     105.375     107.083     3049700 
14243      111         114.417     101.292     107.083     5430600 
14242      116.667     116.708     109.5       110.771     4101300 
14241      110.333     120.625     108.333     117.312     4983100 
14237      107.417     109         106.333     108.271     902300 
14236      109.333     110         106.375     108.333     2427300 
14235      108.979     109.667     102.875     107.458     5293400 
14234      101.167     107.25      100         106.25      5564000 
14231      94.3333     96.3333     92.625      95.5625     3825300 
14230      88          97.1667     86.8542     92.25       11272500 
14229      86.375      100.583     86.3333     96.3333     16966200 
14228      75.6667     81          75.1667     80.9167     6335900 
14227      73.7083     76.6667     72.6667     74.0833     6458500 
14224      70.0208     74.6667     70          74.3333     4244600 
14223      72.5417     74.6667     69.875      71.0417     5060300 
14222      68.4583     74.7708     67.3333     72.0833     7751100 
14221      63.2083     68.625      62.8333     68.0208     4258300  
14220      64.3333     64.6667     61.7083     63.6667     2629000 
14217      65.1667     65.6667     60.8333     62.8333     3709600 
14216      66.375      68.1667     61.6667     63.1667     3639400 
14215      68.9792     69.1667     65.8542     66.5        4941500 
14214      61.8333     69.9167     60.6667     69.8333     7859100 
14213      73.2083     73.4167     63.9167     64          4958700 
14210      72.4167     72.6667     71          72.2083     1597800 
14208      72.1667     74.5        68.3333     70.1042     4587100 
14207      74.6667     77.7083     68.3333     71.5        13612600 
14206      63.625      72.8333     62.0208     72.6667     11296900 
14203      58.3333     60.5833     55          60.2083     11152100 
14202      57          58.5        51          51.0833     6482600 
14201      50.5417     56.875      50.5        54.6667     9855600 
14200      43.125      51.4167     42.8333     49.5        10190300 
14199      42.8333     43.2917     41.1667     42.0833     1982900 
14196      43.9792     44.5        41.9062     42.5833     1490100 
14195      41.8333     44.2917     41.6667     43.6667     1995800 
14194      44.5417     44.75       41.75       42.2083     2743900 
14193      42.75       46.6667     42.7083     43.9167     5729300 
14192      40.625      42.4792     40.25       42.2917     3640600 
14189      42          42.75       41.3333     41.5208     3149000 
14188      42.5625     43.375      42.0833     42.8333     2455400 
14187      43.7917     44          42.2083     43.2708     3397200 
14186      43.7083     44.3542     41.9167     42.0208     3064700 
14185      42.7083     43.8125     41.5        43.6667     5249000 
14182      42.2083     43.2708     41.5417     42.1458     3530400 
14181      40.4375     42.4167     39.6667     42.1667     5488700 
14180      38.9792     39.8333     38.0833     39.0208     3315300 
14179      41.375      42          38.6875     38.7708     3360700 
14178      39.7083     40.625      38.9167     40.4792     3252800 
14175      38.1667     39.4375     38.0417     38.7083     2270800 
14174      35.875      39.2917     35.7917     38.2292     4449200 
14173      36.4792     36.75       35.2083     36.6667     2103000 
14172      36.25       37.5        35.5417     35.5833     3194600 
14171      33          35.625      33          35.25       2780200 
14168      32.875      33.9792     32.3333     33.1458     3567500 
14167      31.4167     32.625      30.8333     32.3542     2828500 
14166      30.3542     32.5417     29.9167     31.1667     2598400 
14165      30.6042     31.7917     30.2083     30.4583     1780900 
14164      32.375      33.6667     31          31.0625     3636200 
14161      30.0833     30.625      27.9167     30.3958     3454500 
14160      27.625      29.3333     26.6667     28.7292     5064100 
14159      34.2083     34.9167     30.4167     31.1458     7139000 
14158      37.1667     37.4167     34.6667     36.1042     4695300 
14157      36.2917     37          33.6667     34.901      4082700 
14154      35.1042     37.2917     33.6667     36.75       5749300 
14153      36          37          33.3333     34.2083     5732000 
14152      37.1667     38.5        36.2708     37.2083     4905100 
14151      39.0833     39.8542     37.1667     37.7083     6389300 
14150      38.7917     40          37.2917     38.5417     6434100 
14147      32.8333     36.875      32.8333     36.4167     6099800 
14146      35.7083     38.9583     33.8333     34.0417     8520700 
14145      30.2708     35.1667     30          35.0417     7597300 
14144      29.4167     30.5        29.2083     29.3958     5050900 
14143      25.3333     28.9583     25.3333     28.5        3961200 
14140      25.9167     27.0625     25.8958     26.5625     2790400 
14139      26.8125     27.8333     25.5        25.6667     7076300 
14138      24.75       28.6458     23.8333     28.1667     6519800 
14137      23.6042     24.9167     23.4583     24.3333     2871400 
14136      26.7917     26.8333     24.5        24.5625     2510000 
14133      26.125      26.9583     24.5        25.3542     3935400 
14132      26.4583     26.8333     25.0833     26.5417     5328300 
14131      29.8333     30.7917     27.7917     28.1667     2982700 
14130      31.3333     31.5833     30          30.75       3656100 
14126      28.8958     30          27.3333     28.75       2968700 
14125      27.875      30.0833     26.9167     28.625      4245200 
14124      27.7083     32          27.3333     29.2917     7888100 
14123      25.375      28.875      21.6667     26.651      11241800 
14122      35.1458     35.875      27.7083     27.9167     6833400 
14119      39.9167     40.2917     34.4167     35.2969     6506000 
14118      41.4583     41.6667     39.6667     39.6667     2671200 
14117      43.25       43.4167     42.2708     42.4167     2731800 
14116      45.8125     45.8333     43.5833     43.875      2391900 
14115      43.4167     45          43.375      44.9167     2324900 
14112      42.4167     43.4271     41.0833     43.2292     2522700 
14111      42.0833     43.25       41.8333     43.0417     2647700 
14110      43.75       44.5833     42.3333     42.9167     3213600 
14109      40.3958     43.0417     39.7083     42.8958     3000100 
14108      40.25       41.0625     39.5        39.8958     2436300 
14105      43.5625     43.5833     40.0833     40.9167     3235000 
14104      43.5417     45          42.3333     42.5        4104900 
14103      42.25       43.8333     41.3542     43.4583     3356800 
14102      38.5        42.2917     38.4167     41.3333     4693100 
14101      39          40.625      38.3333     40.5417     3086000 
14098      37.0833     39.625      36.4583     38.6667     3905500 
14097      34.7917     37.5        34.3542     36.5        3100600 
14096      37.6042     37.7083     33.3333     35.3958     3843400 
14095      36.7083     38.0417     36.0417     36.625      4677500 
14094      36.5833     37.1667     35.75       36.0833     2152200 
14091      38.1667     38.375      36.375      36.9583     2240100 
14090      37.25       38.3333     35.1667     37.9167     5295700 
14089      40.1667     40.5        35.8333     35.9375     3274100 
14088      41.4792     42          39.3333     39.6458     3457800 
14087      39.7083     42.4583     38.5417     41.8542     4805100 
14084      43.0833     43.8333     39          41.4167     4829000 
14083      43.3333     46.1667     42.3333     42.5417     4635100 
14082      44.6667     46.625      43.5        44.6667     4662400 
14081      45.75       49          42.6667     44.0208     7888000 
14080      40.375      46.7083     39.9167     45.8333     5987500 
14077      37.4583     40.1667     37.2917     39.9375     2971000 
14076      37.8125     38.3333     36.1667     37.7917     2333200 
14075      38.6667     39.125      36.5833     37.5        2935000 
14074      36.1667     38.5833     35.6667     38.3333     4226400 
14073      32.1667     36          31.4167     35.875      3208000 
14070      34.3333     35.2917     32.7083     33.1667     4163700 
14069      36.875      38.8333     35          35.1667     4915500 
14068      37.2917     39.6667     34.125      35.7083     9718600 
14067      47.6667     47.9167     40.3333     40.7083     7875300 
14066      42.4583     46.9167     41.8333     46.5        7813900 
14062      38.5833     41.8333     37.5        41.3333     8713300 
14061      33.9375     38.1667     33.5833     38.0417     4709100 
14060      32.6042     33.8333     32.25       33.25       3646200 
14059      31.5833     33.2083     31.5833     32.9167     4084600 
14056      32.5        33.4167     31.25       31.4167     5191600 
14055      33.3333     34.9167     32          33.0208     9077500 
14054      31.6667     33.5833     29.7083     33.2708     9784100 
14053      27.0208     30.9167     26.8333     30.8958     6243900 
14052      24.9167     27.4583     24.0833     27.125      6053000 
14049      23.6875     25.4167     22.6667     25.2708     6113100 
14048      27          27.5        23.9167     24.0417     5273300 
14047      25.2917     27.0625     25.125      26.3333     6710900 
14046      22.25       24.5833     22.1667     24.5417     6527900 
14045      19.8333     22.8333     19.7083     21.9167     5616900 
14042      21.1667     21.1667     19.4167     20.3333     3609300 
14041      18.4167     20.875      18.3333     20.8333     5975200 
14040      17.2083     18.75       17          18.0417     4047500 
14039      15.4792     17.2917     15.4167     17.0833     3239400 
14038      14.6042     15.4375     14.5        15.4167     910500 
14035      14.5833     14.7917     14.375      14.75       571200 
14034      14.3125     14.6458     13.75       14.625      832600 
14033      14.9583     15.0833     14          14.0833     1096900 
14032      14.5417     14.8333     13.8333     14.5625     1366900 
14031      14.6667     14.75       13.8854     14.2708     670300 
14028      14.3125     14.8333     14.25       14.6875     720100 
14027      14.5417     14.625      14.2083     14.3229     784400 
14026      13.3958     14.5625     13.2917     14.4375     1936200 
14021      14.7292     14.7708     14.25       14.3333     488500 
14020      14.9167     15          14.5521     14.7917     283600 
14019      15.0625     15.25       14.7083     14.7708     337400 
14018      14.9375     15.1042     14.875      15.0625     285300 
14017      15          15.1042     14.4583     14.6771     551500 
14014      15.3125     15.4167     14.9167     14.9375     385700 
14013      15.3333     15.7708     15.1667     15.2604     716700 
14012      15.0833     15.6667     14.9583     15.4792     1162000 
14011      14.625      15.3229     14.4375     15.2292     969700 
14010      15.4896     15.5        14.4167     14.4792     947700 
14007      15.2083     15.4583     14.9167     15.3958     399400 
14006      15.1667     15.5        14.7083     15.1667     1157300 
14005      15.6667     15.6667     15.0208     15.0625     619900 
14004      15.6667     15.9167     15.5208     15.6198     499900 
14003      15.8333     15.9792     15.5625     15.875      644600 
14000      15.4583     15.8542     15.0833     15.75       775600 
13999      16.25       16.3333     15.0833     15.2917     1873800 
13998      16.2083     16.4375     15.6042     15.9167     2638100 
13997      15.4792     16.5833     14.8438     15.9375     5799500 
13996      13.8958     14.1042     12.8542     13.7917     1573800 
13993      13.6667     14.625      13.5833     14.1458     1398800 
13992      14.5        14.5        13.4167     13.5        1021100 
13991      15.5417     15.6042     14.5        14.5417     941800 
13990      15.875      15.8958     15.1875     15.5104     696200 
13989      15.8958     16.5833     15.625      15.7083     748300 
13986      15.9688     16.2083     15.75       15.8125     586300 
13985      16.0208     16.5521     15.5312     16.4167     1353700 
13984      16.3333     16.6667     15.75       16.0208     932700 
13983      15.6458     16.6458     15.5417     16.1979     1360300 
13982      15.8125     16.0417     15.3333     15.7188     915000 
13978      15.3958     16          15.2708     15.875      1336200 
13977      14.3958     14.9583     14.25       14.7708     942900 
13976      14.5        14.5417     14.125      14.3333     969500 
13975      15.7083     15.7917     14.7083     14.7708     918700 
13972      16.0417     16.0625     15.375      15.5        974500 
13971      15.1875     16.125      14.9583     15.8438     1386900 
13970      14.2083     15.0625     14.0052     15.0208     1204300 
13969      14.2292     14.4167     13.9583     14.2552     547100 
13968      14.3125     14.5833     14.1875     14.3125     458400 
13965      14.0417     14.5208     13.7917     14.1667     637200 
13964      13.625      13.9583     13.25       13.7917     656500 
13963      14.1667     14.2917     13.5        13.6146     940800 
13962      13.75       14.4583     13.75       14.0417     473400 
13961      13.9271     14.125      13.7917     13.9688     250400 
13958      14          14.1458     13.8542     14          534400 
13957      14.2292     14.5833     13.9583     14          1009600 
13956      13.2083     14.2917     13.2083     14.2188     1138300 
13955      13.2917     13.375      12.9792     13.3125     258400 
13954      13.2604     13.4583     13.1667     13.1667     276000 
13951      13.2708     13.4792     12.9583     13.1146     543600 
13950      13.125      13.5208     12.8542     13.0833     816600 
13949      13.6667     13.75       13.0417     13.2708     1029100 
13948      14.25       14.7083     13.8125     13.8516     2062500 
13947      12.8125     14.2917     12.7917     13.9167     1921300 
13944      12.6042     12.8333     12.2917     12.7917     490600 
13943      11.9583     13.0312     11.875      12.5        1000100 
13942      12          12.375      11.6667     12.2396     609500 
13941      12.5833     12.625      11.9167     11.9583     668000 
13940      12.6458     12.875      12.5        12.7083     913100 
13937      12.0417     13.2708     11.9688     12.8333     2058900 
13936      10.9271     12.1667     10.875      12.125      1281100 
13935      10.9375     11.0833     10.5208     10.9792     562100 
13934      10.8333     11.3542     10.7083     10.8125     1162100 
13933      10.5833     10.8333     10.4167     10.8125     331500 
13930      10.4583     10.5833     10.2292     10.5417     225300 
13929      10.2188     10.5833     10.1667     10.4583     369700 
13928      10.2917     10.2917     10.1042     10.1458     247600 
13927      10.4375     10.4375     10.1458     10.2917     198000 
13923      10.5        10.5417     10.2917     10.375      701700 
13922      10.5417     10.6042     10.375      10.5208     253000 
13921      10.5833     10.9271     10.5625     10.5833     539500 
13920      9.75        10.6354     9.6667      10.6042     1024700 
13919      9.8333      9.9167      9.5417      9.7083      218900 
13916      9.8542      10.0417     9.75        9.8125      176900 
13915      10.2292     10.2292     9.75        9.875       486000 
13914      10.125      10.375      10.1042     10.125      102900 
13913      10.375      10.5        10.1875     10.3021     369100 
13912      9.8958      10.4167     9.875       10.3958     576100 
13909      10          10.125      9.7708      9.8333      310200 
13908      9.5833      9.9792      9.5625      9.9167      403000 
13907      9.5         9.6667      9.25        9.5417      441100 
13906      9.6354      9.7292      9.3333      9.5         342000 
13905      9.9583      9.9792      9.4792      9.625       392700 
13902      10.6875     10.6875     9.875       9.875       759900 
13901      10.1458     10.5417     10.0417     10.2708     789300 
13900      9.875       10.3333     9.75        10.1458     728200 
13899      9.6458      10.0208     9.625       9.9062      455600 
13895      9.9167      9.9583      9.5417      9.5833      213600 
13894      9.5833      10.0208     9.5833      9.9062      501200 
13893      9.3125      9.75        9.25        9.75        708800 
13892      8.6875      9.3333      8.6458      9.2917      610100 
13891      8.3333      8.7708      8.2917      8.6042      616800 
13888      9.3333      9.3333      8.4583      8.5208      553600 
13887      9.3958      9.4062      9.0625      9.2292      501300 
13886      9.6667      9.6667      9.3854      9.5625      227100 
13885      9.3958      9.75        9.3333      9.6771      347900 
13884      9.7708      9.875       9.4167      9.5         299200 
13881      10          10          9.5938      9.9167      138400 
13879      9.75        10.0833     9.6875      10.0417     370500 
13878      9.6667      9.8125      9.5625      9.6979      523800 
13877      9.1667      9.5625      9.0625      9.5         212700 
13874      9.125       9.2917      8.9792      9.0417      40600 
13872      9.25        9.4167      8.9375      9.2083      194700 
13871      9.375       9.4792      9.25        9.25        98100 
13870      9           9.5625      8.8646      9.3958      362700 
13867      8.4583      9.0417      8.3333      9           396100 
13866      8.7083      8.8542      8.4583      8.5833      267000 
13865      8.75        8.9167      8.5104      8.7812      511700 
13864      9.2917      9.2917      8.9167      8.9167      140600 
13863      9.1667      9.3333      8.8125      9.1667      141200 
13860      9.2917      9.6042      8.8125      9.0833      222700 
13859      8.7917      9.6667      8.7917      9.375       417900 
13858      9.1667      9.25        8.7917      9.0208      120400 
13857      9.3333      9.5417      9.2083      9.375       111000 
13856      9.0833      9.5417      9.0417      9.4167      397200 
13853      8.875       9.1875      8.7083      9.1875      221800 
13852      8.8021      9.1042      8.7708      9           253200 
13851      8.3958      8.75        8.375       8.7292      107500 
13850      8.5208      8.6042      8.3542      8.4688      105200 
13849      8.4792      8.75        8.2708      8.5417      198600 
13846      8.5417      8.6667      8.2292      8.25        133600 
13844      8.4792      8.8229      8.4792      8.5208      135900 
13843      8.4792      8.6667      8.0833      8.4062      275400 
13842      8.75        8.8333      8.4583      8.4583      168300 
13839      9.1042      9.1667      8.9792      8.9792      216900 
13838      9.1458      9.2083      9.0208      9.1667      493600 
13837      8.8125      9.0417      8.625       9.0208      211200 
13836      8.75        8.9583      8.6875      8.8333      155500 
13835      8.4583      9.0833      8.4375      8.75        616200 
13832      7.875       8.4167      7.5625      8.3333      489100 
13831      7.8958      7.9375      7.5417      7.7188      357500 
13830      7.5521      8.375       7.3333      7.5417      723600 
13829      8.4896      8.625       7.8333      7.8958      359400 
13828      9           9.125       8.4167      8.4167      230400 
13825      8.8333      9.2812      8.7708      8.9583      218900 
13824      9.8333      9.8333      9.2708      9.3229      242800 
13823      9.9583      10.2396     9.75        9.75        257800 
13822      10          10.1042     9.6458      9.9167      197100 
13821      10.4375     10.4375     9.8958      10.1458     166600 
13818      10.7292     10.9167     9.9375      10.1667     418900 
13817      10.4167     10.7083     10.0833     10.25       397500 
13816      10.2917     11          10          10.7812     593900 
13815      7.8333      10          7.75        9.8958      976600 
13814      9.6042      10.0208     8.4583      8.5417      507600 
13811      9.5         10.125      9.0833      10.0521     791000 
13810      8.4583      9.125       8.375       9           471400 
13809      8.8333      9.2396      8.75        9.0417      434000 
13808      7.9167      8.875       7.7083      8.8542      1008000 
13807      7.3542      7.75        7.3333      7.6458      409400 
13804      7.2292      7.3125      7.0417      7.25        211200 
13803      7.9583      7.9583      7.2083      7.25        290100 
13802      7.9375      7.9375      7.5417      7.8438      196300 
13801      8.125       8.2083      7.6667      7.9583      128900 
13800      7.8542      8.0833      7.8542      8           67900 
13797      7.4583      8.125       7.3333      7.8021      315600 
13796      8           8.0417      7.4792      7.5         329200 
13795      8.2917      8.3333      7.9688      8.0104      233900 
13794      8.1667      8.375       8.0833      8.1146      145200 
13793      8           8.25        7.8854      8.25        169000 
13790      8.1667      8.25        7.9583      8.0312      97000 
13789      8.0833      8.3542      7.9792      8.0208      156400 
13788      8.875       9           7.875       8.0417      416600 
13787      8           8.6979      7.6042      8.6771      437900 
13786      8.2917      8.375       7.9167      8.0833      197600 
13783      8.1458      8.5208      8.1042      8.3333      227600 
13782      8.6875      8.7083      8.1042      8.1562      414000 
13781      9.2917      9.625       8.5833      8.75        683400 
13780      8.9792      9.2917      8.7917      9.25        640200 
13779      8           9.3542      7.8958      9           1411500 
13776      6.7604      8.1667      6.75        7.8958      744100 
13775      6.875       6.9375      6.5625      6.5833      177400 
13774      6.9167      7           6.6667      6.8125      217300 
13773      6.25        7.0833      6.2396      6.7083      536000 
13772      7.3333      7.3542      6.1042      6.1875      465300 
13769      6.375       7.3958      6.3125      7.375       277800 
13768      6.6667      6.6667      6.0833      6.3125      355200 
13767      6.625       6.6562      6.25        6.6042      322200 
13766      6.2812      6.7708      6.0521      6.4792      747600 
13765      5.0625      6.0417      5           6           470700 
13762      5.1667      5.3333      4.9167      5           159000 
13761      4.7292      5.1042      4.6875      5.1042      279000 
13760      4.6875      4.8333      4.625       4.6667      163700 
13759      4.6875      4.75        4.6667      4.7083      61000 
13755      4.7292      4.75        4.6458      4.6771      60200 
13754      4.6042      4.7917      4.5625      4.75        95600 
13753      4.6146      4.6458      4.5         4.6354      116000 
13752      4.4792      4.7083      4.4583      4.6875      214500 
13751      4.2083      4.5208      4.2083      4.4375      93900 
13748      4.2083      4.25        4.1875      4.25        59400 
13747      4.2708      4.3438      4.1458      4.2292      52000 
13746      4.375       4.375       4.1458      4.3333      83300 
13745      4.1875      4.4167      4.1042      4.3333      83600 
13744      4.1042      4.1042      3.9375      4.0833      148700 
13741      4.2708      4.3125      3.875       4.2292      133100 
13740      4.3542      4.5         4.2396      4.3125      86800 
13739      4.4583      4.4583      4.3333      4.3958      49200 
13738      4.5625      4.6042      4.3958      4.3958      47600 
13737      4.5833      4.6667      4.5         4.6562      103300 
13734      4.3333      4.6042      4.2083      4.5833      184300 
13733      4.5         4.5208      4.25        4.3542      169500 
13732      4.4167      4.625       4.375       4.5         103600 
13731      4.6667      4.6667      4.2917      4.4167      252700 
13730      4.75        4.8229      4.6042      4.625       222600 
13727      4.6875      4.8333      4.5         4.8333      299000 
13726      4.875       4.875       4.6667      4.7917      121200 
13725      5           5.0104      4.8542      4.8958      209800 
13724      4.7292      5           4.6667      4.9583      401200 
13723      4.4583      4.7917      4.4375      4.6458      214500 
13720      4.4375      4.5         4.4375      4.4583      51700 
13719      4.6042      4.625       4.4375      4.5208      101400 
13718      4.375       4.6667      4.3542      4.5833      271600 
13717      4.3333      4.375       4.125       4.2708      130300 
13716      4.3542      4.3958      4.2917      4.3646      47900 
13713      4.375       4.4375      4.3125      4.3125      65000 
13712      4.6875      4.6875      4.3125      4.4375      264100 
13711      4.8958      4.9896      4.6042      4.6667      252000 
13710      4.2708      4.9583      4.2708      4.875       772900 
13709      4.6458      4.6667      4.2292      4.2708      383700 
13706      5.0417      5.0417      4.4167      4.5833      877600 
13705      4.6667      5.1458      4.6667      5.125       754300 
13704      4.6042      4.7708      4.5417      4.6458      688500 
13703      4.0833      4.6667      4.0833      4.6042      1293100 
13702      3.6667      4.0417      3.6667      4           671100 
13698      3.1979      3.8333      3.1875      3.8229      1048100 
13697      3.0312      3.1875      3.0208      3.1771      323500 
13696      3.0833      3.0833      3.0208      3.0312      107700 
13695      3.0208      3.1979      2.9583      3.0833      228900 
13692      3.0312      3.0312      2.9583      2.9792      99000 
13691      3.0417      3.0417      3.0104      3.0208      265800 
13690      3.0521      3.0521      2.9792      3.0208      175500 
13689      3.0104      3.0521      2.9583      3.0208      62600 
13688      3.0833      3.0833      2.9583      3           87300 
13685      3.0625      3.1042      3           3.0521      282300 
13684      3.0208      3.0625      3           3.0208      83600 
13683      3.0417      3.0729      3           3.0208      205400 
13682      3.1979      3.1979      2.9896      3.0104      392200 
13681      3.2083      3.2083      3.125       3.1458      76100 
13678      3.25        3.25        3.1667      3.1667      57800 
13677      3.1667      3.2917      3.1042      3.2083      136000 
13676      3.1875      3.2083      3.0625      3.0833      99000 
13675      3.4167      3.4167      3.0625      3.1667      454900 
13674      3.3125      3.4167      3.3125      3.375       196000 
13671      3.0312      3.4167      3.0208      3.3125      650600 
13670      2.8333      3.0833      2.75        3.0833      472700 
13669      2.9583      2.9792      2.7917      2.8333      256700 
13668      3.0625      3.0625      2.9583      2.9583      98600 
13667      3.0208      3.0625      3           3.0208      49300 
13664      3           3.0208      2.9583      3           216200 
13663      3.0833      3.0833      2.9583      3.0104      289400 
13662      3.25        3.2708      3.0625      3.0625      381200 
13661      3.0208      3.2917      2.9167      3.1667      724800 
13657      2.8125      3.0417      2.6667      3           1328100 
13656      2.875       2.8958      2.625       2.7917      981400 
13655      3.2708      3.2917      2.75        2.8542      1571100 
13654      3.4583      3.5         3.2708      3.2708      455600 
13653      3.5208      3.5417      3.25        3.4167      508900 
13650      3.9375      3.9583      3.4167      3.4583      1225000 
; 
RUN;

PROC SORT;
   BY DATE;
RUN;

DATA NEXT;
   SET AMAZON END=EOF;
   OUTPUT;
   IF EOF THEN DO I=1 TO 100;
   DATE=INTNX('DAY',DATE,1);
   OPEN=.;
   HIGH=.;
   LOW=.;
   CLOSE=.;
   VOLUME=.;
   SPREAD=.;
   OUTPUT;
   END;
RUN;

PROC REG DATA=NEXT;
   MODEL CLOSE SPREAD VOLUME=DATE;
   OUTPUT OUT=OUT1 PREDICTED=PCLOSE PSPREAD PVOL;
RUN;

PROC ARIMA DATA=NEXT;
   I VAR= CLOSE CROSSCOR=(DATE) NLAG=10;
   E P=1 INPUT=(DATE) ML;
   F LEAD=100 OUT=OUT1 ID=DATE;
   I VAR = CLOSE OUTCOV= ACFCL;
   I VAR = CLOSE(1) OUTCOV=ACFCD; 
   E;
   F LEAD=100 OUT=OUT2; 
   I VAR = SPREAD OUTCOV=ACFSL;
   E P=2 Q=(2) ML;
   I VAR = SPREAD(1) OUTCOV=ACFSD;
   I VAR=VOLUME OUTCOV=ACFVL;
   I VAR=VOLUME(1) OUTCOV=ACFVD;
   E Q=2 ML;
RUN;


DATA ALL;
   MERGE OUT1 (RENAME=(FORECAST=FTREND L95=LTREND U95=UTREND ))
         OUT2 (RENAME=(FORECAST=FUNIT  L95=LUNIT  U95=UUNIT ));
   LINEAR = -71.43680 + .0053150*DATE;
   IF DATE<14389 THEN DO; LUNIT=.; UUNIT=.; LTREND=.; UTREND=.;
   END;
RUN;

DATA DFTEST;
SET NEXT;
   LAGV = LAG(VOLUME);
   DV = VOLUME-LAG(VOLUME);
   LAGC = LAG(CLOSE);
   DC = CLOSE-LAG(CLOSE);
   LAGS = LAG(SPREAD);
   DS = SPREAD-LAG(SPREAD);
OUTPUT;
RETAIN;
   DV10=DV9; DV9=DV8; DV8=DV7; DV7=DV6; DV6=DV5; DV5=DV4; DV4=DV3;
   DV3=DV2; DV2=DV1; DV1=DV;
   DC10=DC9; DC9=DC8; DC8=DC7; DC7=DC6; DC6=DC5; DC5=DC4; DC4=DC3;
   DC3=DC2; DC2=DC1; DC1=DC;
   DS10=DS9; DS9=DS8; DS8=DS7; DS7=DS6; DS6=DS5; DS5=DS4; DS4=DS3;
   DS3=DS2; DS2=DS1; DS1=DS;
RUN;

PROC REG;
   MODEL DC = DATE LAGC  / SS1;
             *test DC1=0, DC2=0, DC3=0, DC4=0;
             *test DC5=0, DC6=0, DC7=0, DC8=0, DC9=0, DC10=0;
   MODEL DS = DATE LAGS DS1-DS2 / SS1;
             *test DS3=0, DS4=0;
             *test DS5=0, DS6=0, DS7=0, DS8=0, DS9=0, DS10=0;
   MODEL DV = DATE LAGV DV1-DV2 / SS1;
             *test DV3=0, DV4=0;
             *test DV5=0, DV6=0, DV7=0, DV8=0, DV9=0, DV10=0;
RUN;

PROC ARIMA DATA=NEXT; 
   I VAR=CLOSE(1) CROSSCOR=(DATE) NOPRINT; E;
   F LEAD=100 ID=DATE OUT=OUTCLOSED; 
   I VAR=CLOSE CROSSCOR=(DATE) NOPRINT; E P=1 INPUT=(DATE);
   F LEAD=100 ID=DATE OUT=OUTCLOSEL;
   I VAR=SPREAD CROSSCOR=DATE NOPRINT;  E INPUT=(DATE) P=3;
   I VAR=VOLUME CROSSCOR=(DATE) NOPRINT; E INPUT=(DATE) P=3;
RUN;

DATA LOGS; 
   MERGE OUTCLOSED(RENAME=(L95=L95D U95=U95D FORECAST = YD))
         OUTCLOSEL(RENAME=(L95=L95L U95=U95L FORECAST = YL)); 
   LINE = -68.07995 + .0050776*DATE;
   IF CLOSE NE . THEN DO; L95L=.; U95L=.;L95D=.; U95D=.; END;
RUN;

DATA LEVELS;
SET LOGS; 
   LINE=EXP(LINE); L95D=EXP(L95D); L95L=EXP(L95L); U95D=EXP(U95D); U95L=EXP(U95L);
   CLOSE=EXP(CLOSE); YD=EXP(YD); YL=EXP(YL);
RUN;


 /* Use the DATA step below with the appropriate PROC statements in        */
 /* Chapter 3, "The General ARIMA Model," of SAS FOR                       */
 /* FORECASTING TIME SERIES, SECOND EDITION, to produce Output 3.23-3.24.  */


DATA WORKERS;
   INPUT NONPUB @@;
   TITLE 'PUBLISHING AND PRINTING NONPRODUCTION WORKERS';
   TITLE2 '1944-1977';
   RETAIN YEAR 1943;
   YEAR+1;
   CARDS;
33.5 34.0 33.5 32.5 33.2 34.1 34.0 34.3 34.6 35.0 35.5 35.4 35.1 35.2
35.5 35.3 35.4 35.5 36.6 36.7 36.6 36.4 36.9 37.4 37.7 38.5 39.1 39.7
40.6 42.4 43.2 43.4 43.7 43.5 
;
RUN;

/*3.25*/

DATA A;
   A=.8; B=.4; Y1=0; E1=0;
DO T=1 TO 1000;
   E = NORMAL(1726555);
   Y = A*Y1 + E -B*E1;
   OUTPUT;
   E1=E; Y1=Y; 
END;
RUN;

/*3.26-3.27*/

DATA IBL;
INPUT LOANS@@;
RETAIN DATE '01DEC71'D;
DATE = INTNX('MONTH',DATE,1); 
FORMAT DATE MONYY.; 
LEVELS=LOANS; DLEVELS=LEVELS-LAG(LEVELS); 
LOANS=LOG(LOANS);
LABEL LOANS = "INTERBANK LOANS IN BILLION $"; 
DLOANS=LOANS-LAG(LOANS);  
CARDS; 
 26.8  27.5  27.7  28.4  30.3  30.7  31.8  31.9  31.8  32.8  33.7  35.3  38.5  38.7  39.4
 39.4  39.1  39.1  38.9  40.2  39.1  39.9  40.7  39.4  38.7  40.4  41.6  39.4  40.6  40.5
 40.6  40.6  39.2  38.8  39.3  37.5  39.2  40.2  40.2  39.5  39.6  38.9  40.3  41.9  43.9
 43.8  43.2  45.8  44.3  42.6  43.3  45.1  46.5  46.1  48.0  47.4  50.7  51.0  50.4  53.0
 51.6  50.7  51.4  52.4  52.2  53.2  50.6  51.0  53.6  54.0  57.0  56.5  52.6  53.8  56.9
 58.6  59.8  63.7  64.1  68.1  72.4  72.4  72.6  74.8  74.0  77.2  76.2  78.9  86.3  86.4
 87.1  92.7  90.4  92.2  98.0 100.6 101.9 104.1 107.9 107.0 103.1 103.5 104.8 103.4 105.2
104.8 110.1 109.5 111.9 111.1 114.1 110.0 112.8 110.2 113.6 117.1 119.2 121.1 116.3 116.9
118.3 114.7 114.1 113.4 112.8 111.7 117.9 112.7 113.2 117.6 110.3 109.3 116.7 118.3 118.1
119.5 125.2 126.6 124.9 126.8 124.5 125.4 125.5 126.9 126.5 129.2 130.4 132.9 136.9 139.9
137.9 139.1 142.2 142.3 149.3 149.8 144.4 147.1 153.3 157.6 154.4 155.7 156.7 157.4 157.4
155.7 157.5 164.1 168.6 163.9 164.5 165.3 167.1 164.8 166.8 166.7 167.2 174.2 164.6 162.8
160.3 164.4 164.8 167.7 163.3 165.8 165.3 163.7 163.2 164.2 162.9 160.5 162.2 172.4 169.2
162.3 167.5 164.9 168.3 173.3 174.8 176.4 179.2 182.8 182.5 185.9 194.9 192.6 191.4 196.2
204.2 212.0 209.4 198.3 198.3 195.8 185.5 183.2 179.1 175.7 170.9 168.3 166.5 170.0 173.9
170.8 169.3 169.4 181.7 181.6 177.7 178.7 174.2 170.3 163.6 161.9 161.8 161.0 164.6 164.3
158.0 152.6 153.3 148.1 153.9 159.7 160.6 155.4 153.8 153.2 152.6 155.7 155.2 154.3 147.8
149.0 155.2 154.0 159.7 159.8 161.9 166.4 170.4 177.3 181.7 180.4 180.5 178.8 184.1 186.0
195.1 191.2 194.3 198.6 197.5 202.8 209.1 194.3 199.8 205.5 206.7 203.1 199.9 200.9 207.3
204.5 212.6 205.3 203.2 206.8 212.4 210.6 214.9 186.6 181.5 189.2 195.8 195.7 201.3 211.0
205.3 202.1 213.8 213.9 202.6 216.0 212.1 207.3 220.6 220.6 221.5 218.1 223.3 226.5 220.4
218.4 225.8 221.7 222.4 216.8 214.3 224.9 223.4 226.9 221.3 229.0 225.1 223.8 227.8 225.6
241.1 245.4 238.5 246.5 245.9 252.2 270.2 266.7 275.2 292.1
;
RUN;
